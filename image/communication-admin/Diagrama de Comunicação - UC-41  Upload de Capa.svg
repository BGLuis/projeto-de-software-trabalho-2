<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="716px" preserveAspectRatio="none" style="width:3574px;height:716px;background:#FFFFFF;" version="1.1" viewBox="0 0 3574 716" width="3574px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="354" x="1603.25" y="24.9659">Diagrama de Comunica&#231;&#227;o - UC-41: Upload de Capa</text><g id="elem_Client"><rect fill="#F1F1F1" height="58.1358" style="stroke:#181818;stroke-width:0.5;" width="62" x="112.5" y="143.8579"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="119.5" y="160.8239">:Admin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="124" y="179.8918">Client</text><line style="stroke:#181818;stroke-width:0.5;" x1="113.5" x2="173.5" y1="185.9938" y2="185.9938"/></g><g id="elem_Controller"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="168" x="450.5" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="457.5" y="170.3539">:AdminBooksController</text><line style="stroke:#181818;stroke-width:0.5;" x1="451.5" x2="617.5" y1="176.4558" y2="176.4558"/></g><g id="elem_UploadService"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="146" x="841.5" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="848.5" y="170.3539">:BookUploadService</text><line style="stroke:#181818;stroke-width:0.5;" x1="842.5" x2="986.5" y1="176.4558" y2="176.4558"/></g><g id="elem_FilesService"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="96" x="1331.5" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="1338.5" y="170.3539">:FilesService</text><line style="stroke:#181818;stroke-width:0.5;" x1="1332.5" x2="1426.5" y1="176.4558" y2="176.4558"/></g><g id="elem_BookRepo"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="121" x="1916" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="1923" y="170.3539">:BookRepository</text><line style="stroke:#181818;stroke-width:0.5;" x1="1917" x2="2036" y1="176.4558" y2="176.4558"/></g><g id="elem_CoverRepo"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="127" x="3300" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="3307" y="170.3539">:CoverRepository</text><line style="stroke:#181818;stroke-width:0.5;" x1="3301" x2="3426" y1="176.4558" y2="176.4558"/></g><g id="elem_Cache"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="96" x="3472.5" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="3479.5" y="170.3539">:RedisCache</text><line style="stroke:#181818;stroke-width:0.5;" x1="3473.5" x2="3567.5" y1="176.4558" y2="176.4558"/></g><g id="elem_FileStorage"><rect fill="#F1F1F1" height="39.0679" style="stroke:#181818;stroke-width:0.5;" width="93" x="1777" y="153.3879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1784" y="170.3539">:FileStorage</text><line style="stroke:#181818;stroke-width:0.5;" x1="1778" x2="1869" y1="176.4558" y2="176.4558"/></g><g id="elem_DBMaster"><rect fill="#F1F1F1" height="58.1358" style="stroke:#181818;stroke-width:0.5;" width="111" x="2339" y="143.8579"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="2361" y="160.8239">:Database</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="2346" y="179.8918">MySQL Master</text><line style="stroke:#181818;stroke-width:0.5;" x1="2340" x2="2449" y1="185.9938" y2="185.9938"/></g><g id="elem_GMN18"><path d="M2496.5,132.5079 L2496.5,213.332 L2740.5,213.332 L2740.5,142.5079 L2730.5,132.5079 L2496.5,132.5079 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2730.5,132.5079 L2730.5,142.5079 L2740.5,142.5079 L2730.5,132.5079 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="2502.5" y="151.4049">Valida&#231;&#245;es:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="2502.5" y="169.1109">- MIME type (image/jpeg, image/png)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="2502.5" y="186.817">- Tamanho m&#225;ximo (5MB)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="2502.5" y="204.523">- Dimens&#245;es m&#237;nimas (400x600)</text></g><g id="elem_GMN23"><path d="M2786,132.5079 L2786,213.332 L2973,213.332 L2973,142.5079 L2963,132.5079 L2786,132.5079 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2963,132.5079 L2963,142.5079 L2973,142.5079 L2963,132.5079 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="2792" y="151.4049">Processamento:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="2792" y="169.1109">- Gerar thumbnail (200x300)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="2792" y="186.817">- Otimizar qualidade (85%)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="2792" y="204.523">- Salvar original + thumbnail</text></g><g id="elem_GMN33"><path d="M3019,150.2179 L3019,195.6299 L3254,195.6299 L3254,160.2179 L3244,150.2179 L3019,150.2179 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M3244,150.2179 L3244,160.2179 L3254,160.2179 L3244,150.2179 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="3025" y="169.1149">isPrimary = true se for primeira capa</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="3025" y="186.8209">isPrimary = false caso contr&#225;rio</text></g><g id="elem_GMN42"><path d="M6,274.3379 L6,709.2823 A0,0 0 0 0 6,709.2823 L281,709.2823 A0,0 0 0 0 281,709.2823 L281,284.3379 L271,274.3379 L147.5,274.3379 L143.5,202.3179 L139.5,274.3379 L6,274.3379 A0,0 0 0 0 6,274.3379 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M271,274.3379 L271,284.3379 L281,284.3379 L271,274.3379 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="12" y="293.2349">Fluxo UC-41: Upload de Capa</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="12" y="310.9409">1. Admin faz upload de imagem (multipart)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="12" y="328.647">2. Valida que livro existe</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="12" y="346.353">3. Valida imagem:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="21" y="364.059">- Formato (JPEG/PNG)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="21" y="381.765">- Tamanho (max 5MB)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="21" y="399.471">- Dimens&#245;es m&#237;nimas</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="12" y="417.177">4. Processa imagem:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="21" y="434.8831">- Salva original</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="21" y="452.5891">- Gera thumbnail otimizado</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="12" y="470.2951">5. Registra capa no banco:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="21" y="488.0011">- Primeira capa = isPrimary: true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="21" y="505.7071">- Demais = isPrimary: false</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="12" y="523.4131">6. Invalida cache do livro</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="12" y="541.1192">7. Retorna dados da capa</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3" x="12" y="558.8252">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145" x="12" y="576.5312">Estrutura de Arquivos:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="12" y="594.2372">/data/covers/{bookId}/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="18" y="611.9432">- original_{uuid}.jpg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="18" y="629.6492">- thumb_{uuid}.jpg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="3" x="12" y="647.3553">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94" x="12" y="665.0613">URLs Geradas:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="12" y="682.7673">- /files/covers/{bookId}/original_{uuid}.jpg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="12" y="700.4733">- /files/covers/{bookId}/thumb_{uuid}.jpg</text></g><!--link Client to Controller--><g id="link_Client_Controller"><path codeLine="17" d="M174.84,172.9179 C234,172.9179 357.97,172.9179 444.38,172.9179 " fill="none" id="Client-to-Controller" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="450.38,172.9179,441.38,168.9179,445.38,172.9179,441.38,176.9179,450.38,172.9179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="11" x="198" y="112.8149">1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="212" y="112.8149">POST /admin/books/:bookId/covers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="208" y="130.5209">Content-Type: multipart/form-data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="267" y="148.227">file: image/jpeg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="210" y="165.933">Authorization: Bearer adminToken</text></g><!--link Controller to Client--><g id="link_Controller_Client"><path codeLine="64" d="M450.12,187.4279 C392.53,195.3479 314.56,202.1979 246,194.9179 C221.75,192.3479 200.621,187.8925 180.451,182.8525 " fill="none" id="Controller-to-Client" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="174.63,181.3979,182.3918,187.4604,179.4809,182.61,184.3312,179.699,174.63,181.3979" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="11" x="247" y="190.8149">2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="261" y="190.8149">201 Created {cover}</text></g><!--link Controller to UploadService--><g id="link_Controller_UploadService"><path codeLine="19" d="M618.83,172.9179 C685.52,172.9179 771.68,172.9179 835.3,172.9179 " fill="none" id="Controller-to-UploadService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="841.3,172.9179,832.3,168.9179,836.3,172.9179,832.3,176.9179,841.3,172.9179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="642" y="165.8149">1.1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="667" y="165.8149">uploadCover(bookId, file)</text></g><!--link UploadService to Controller--><g id="link_UploadService_Controller"><path codeLine="63" d="M841.25,185.5179 C815.63,189.3479 786.62,193.0379 760,194.9179 C713.21,198.2379 667.0245,194.5022 624.6845,188.7022 " fill="none" id="UploadService-to-Controller" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="618.74,187.8879,627.1139,193.0724,623.6937,188.5665,628.1996,185.1464,618.74,187.8879" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="701" y="190.8149">1.2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="726" y="190.8149">cover</text></g><!--link UploadService to BookRepo--><g id="link_UploadService_BookRepo"><path codeLine="21" d="M942.3,153.0379 C972.96,132.4379 1024.58,101.5779 1074.5,89.3279 C1160.94,68.1079 1691.03,78.7679 1893.5,132.5079 C1910.54,137.0279 1922.9578,142.3196 1937.6278,150.0896 " fill="none" id="UploadService-to-BookRepo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1942.93,152.8979,1936.8489,145.1506,1938.5115,150.5576,1933.1045,152.2202,1942.93,152.8979" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1075.5" y="89.4049">1.1.1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="1111.5" y="89.4049">findOne({id: bookId})</text></g><!--link BookRepo to UploadService--><g id="link_BookRepo_UploadService"><path codeLine="24" d="M1942.93,152.8979 C1928.26,145.1279 1910.54,137.0279 1893.5,132.5079 C1691.03,78.7679 1160.94,68.1079 1074.5,89.3279 C1024.58,101.5779 977.9403,129.0917 947.2803,149.6917 " fill="none" id="BookRepo-to-UploadService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="942.3,153.0379,952.0012,151.3388,946.4502,150.2494,947.5396,144.6985,942.3,153.0379" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1123" y="89.4049">1.1.2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="1159" y="89.4049">book</text></g><!--link BookRepo to DBMaster--><g id="link_BookRepo_DBMaster"><path codeLine="22" d="M2037.28,172.9179 C2118.23,172.9179 2254.29,172.9179 2332.66,172.9179 " fill="none" id="BookRepo-to-DBMaster" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2338.66,172.9179,2329.66,168.9179,2333.66,172.9179,2329.66,176.9179,2338.66,172.9179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="2061" y="165.8149">1.1.1.1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="2108" y="165.8149">SELECT * FROM books WHERE id=?</text></g><!--link DBMaster to BookRepo--><g id="link_DBMaster_BookRepo"><path codeLine="23" d="M2338.58,182.9479 C2309.82,187.6079 2274.15,192.6179 2242,194.9179 C2194.12,198.3579 2181.88,198.2479 2134,194.9179 C2101.91,192.6879 2072.3392,188.857 2043.1792,184.337 " fill="none" id="DBMaster-to-BookRepo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2037.25,183.4179,2045.5311,188.7493,2042.191,184.1838,2046.7565,180.8437,2037.25,183.4179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="2135" y="190.8149">1.1.1.2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="2182" y="190.8149">bookData</text></g><!--link UploadService to FilesService--><g id="link_UploadService_FilesService"><path codeLine="26" d="M987.95,184.4679 C1018.09,188.6579 1053.39,192.8679 1085.5,194.9179 C1151.14,199.1279 1167.91,199.8379 1233.5,194.9179 C1266.22,192.4679 1296.8071,187.9868 1325.1271,183.1068 " fill="none" id="UploadService-to-FilesService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1331.04,182.0879,1321.4915,179.6743,1326.1126,182.937,1322.85,187.5581,1331.04,182.0879" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1086.5" y="190.8149">1.1.3:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1122.5" y="190.8149">validateImage(file)</text></g><!--link FilesService to UploadService--><g id="link_FilesService_UploadService"><path codeLine="33" d="M1331.09,192.6979 C1303.1,203.0679 1266.91,214.6779 1233.5,219.9179 C1201.01,225.0179 1118.09,224.3179 1085.5,219.9179 C1046.9,214.7179 1010.4229,204.9804 977.5929,194.6404 " fill="none" id="FilesService-to-UploadService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="971.87,192.8379,979.2527,199.3568,976.6391,194.34,981.6559,191.7263,971.87,192.8379" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1114" y="215.8149">1.1.4:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="1150" y="215.8149">validated</text></g><!--link UploadService to FilesService--><g id="link_UploadService_FilesService"><path codeLine="35" d="M987.99,154.2479 C995.38,152.8879 1002.82,151.7379 1010,150.9179 C1043.01,147.1679 1276.16,145.9179 1309,150.9179 C1316.22,152.0179 1317.9392,152.1573 1325.2392,154.1373 " fill="none" id="UploadService-to-FilesService-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1331.03,155.7079,1323.3909,149.4914,1326.2044,154.399,1321.2967,157.2125,1331.03,155.7079" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1087" y="140.8149">1.1.5:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1123" y="140.8149">processImage(file)</text></g><!--link FilesService to UploadService--><g id="link_FilesService_UploadService"><path codeLine="49" d="M1331.01,172.9179 C1249.34,172.9179 1089.9,172.9179 993.92,172.9179 " fill="none" id="FilesService-to-UploadService-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="987.92,172.9179,996.92,176.9179,992.92,172.9179,996.92,168.9179,987.92,172.9179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1011" y="165.8149">1.1.6:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="1047" y="165.8149">{originalPath, thumbPath, size, dimensions}</text></g><!--link DBMaster to GMN18--><g id="link_DBMaster_GMN18"><path d="M2450.5,172.9179 C2465.7,172.9179 2480.91,172.9179 2496.11,172.9179 " fill="none" id="DBMaster-GMN18" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--link GMN18 to GMN23--><g id="link_GMN18_GMN23"><path d="M2740.84,172.9179 C2755.74,172.9179 2770.63,172.9179 2785.53,172.9179 " fill="none" id="GMN18-GMN23" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--link FilesService to FileStorage--><g id="link_FilesService_FileStorage"><path codeLine="43" d="M1427.86,172.9179 C1513.72,172.9179 1685.69,172.9179 1770.54,172.9179 " fill="none" id="FilesService-to-FileStorage" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1776.54,172.9179,1767.54,168.9179,1771.54,172.9179,1767.54,176.9179,1776.54,172.9179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1451.25" y="165.8149">1.1.5.1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="1498.25" y="165.8149">write(/covers/{bookId}/original_{uuid}.jpg)</text></g><!--link FileStorage to FilesService--><g id="link_FileStorage_FilesService"><path codeLine="44" d="M1776.66,155.9179 C1769.25,153.8479 1761.6,152.0579 1754.25,150.9179 C1720.87,145.7479 1483.64,145.8479 1450.25,150.9179 C1442.87,152.0379 1441.0009,152.2178 1433.5509,154.2378 " fill="none" id="FileStorage-to-FilesService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1427.76,155.8079,1437.4931,157.3133,1432.5858,154.4995,1435.3996,149.5921,1427.76,155.8079" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1542.25" y="140.8149">1.1.5.2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1589.25" y="140.8149">originalPath</text></g><!--link FilesService to FileStorage--><g id="link_FilesService_FileStorage"><path codeLine="46" d="M1427.97,189.7179 C1435.99,191.8779 1444.29,193.7479 1452.25,194.9179 C1485.22,199.7979 1719.29,199.8979 1752.25,194.9179 C1760.31,193.7079 1762.9494,193.3656 1771.0394,191.1156 " fill="none" id="FilesService-to-FileStorage-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1776.82,189.5079,1767.0773,188.0657,1772.0028,190.8477,1769.2209,195.7732,1776.82,189.5079" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1453.25" y="190.8149">1.1.5.3:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="1500.25" y="190.8149">write(/covers/{bookId}/thumb_{uuid}.jpg)</text></g><!--link FileStorage to FilesService--><g id="link_FileStorage_FilesService"><path codeLine="47" d="M1800.88,192.8179 C1787.67,203.0879 1770.13,214.5579 1752.25,219.9179 C1736.29,224.7079 1468.24,224.6379 1452.25,219.9179 C1434.08,214.5579 1420.947,206.7184 1407.447,196.4584 " fill="none" id="FileStorage-to-FilesService-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1402.67,192.8279,1407.4151,201.4583,1406.6508,195.8533,1412.2558,195.089,1402.67,192.8279" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="1544.25" y="215.8149">1.1.5.4:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="1591.25" y="215.8149">thumbPath</text></g><!--link UploadService to CoverRepo--><g id="link_UploadService_CoverRepo"><path codeLine="51" d="M987.74,164.2879 C1066.78,155.2279 1196.41,141.1379 1308.5,132.5079 C1829.09,92.4579 1960.56,75.1679 2482.5,89.3279 C2836.22,98.9279 2934.37,46.0679 3277.5,132.5079 C3295.26,136.9779 3308.4409,142.4403 3323.7309,150.2803 " fill="none" id="UploadService-to-CoverRepo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3329.07,153.0179,3322.8865,145.3521,3324.6208,150.7366,3319.2363,152.4709,3329.07,153.0179" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="2149.5" y="89.4049">1.1.7:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="2185.5" y="89.4049">save({bookId, imagePath, thumbPath, isPrimary})</text></g><!--link CoverRepo to UploadService--><g id="link_CoverRepo_UploadService"><path codeLine="58" d="M3329.07,153.0179 C3313.78,145.1779 3295.26,136.9779 3277.5,132.5079 C2934.37,46.0679 2836.22,98.9279 2482.5,89.3279 C1960.56,75.1679 1829.09,92.4579 1308.5,132.5079 C1196.41,141.1379 1072.741,154.5446 993.701,163.6046 " fill="none" id="CoverRepo-to-UploadService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="987.74,164.2879,997.137,167.237,992.7075,163.7185,996.2259,159.289,987.74,164.2879" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="2281" y="89.4049">1.1.8:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="2317" y="89.4049">cover</text></g><!--link CoverRepo to DBMaster--><g id="link_CoverRepo_DBMaster"><path codeLine="52" d="M3336.48,153.0479 C3306.65,132.4579 3256.38,101.5979 3207.5,89.3279 C3128.26,69.4379 2552.22,110.6379 2473.5,132.5079 C2463.85,135.1879 2459.4447,136.5755 2450.1247,140.9355 " fill="none" id="CoverRepo-to-DBMaster" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2444.69,143.4779,2454.537,143.2874,2449.2189,141.3592,2451.1471,136.0411,2444.69,143.4779" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="2927" y="80.4049">1.1.7.1:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404" x="2974" y="80.4049">INSERT INTO covers (book_id, image_path, thumb_path, is_primary)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="3102.5" y="98.1109">VALUES (?, ?, ?, ?)</text></g><!--link DBMaster to CoverRepo--><g id="link_DBMaster_CoverRepo"><path codeLine="57" d="M2444.69,143.4779 C2454.01,139.1179 2463.85,135.1879 2473.5,132.5079 C2552.22,110.6379 3128.26,69.4379 3207.5,89.3279 C3256.38,101.5979 3301.7121,129.0495 3331.5421,149.6395 " fill="none" id="DBMaster-to-CoverRepo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3336.48,153.0479,3331.3454,144.6434,3332.3651,150.2076,3326.8009,151.2273,3336.48,153.0479" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="3098.5" y="89.4049">1.1.7.2:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="3145.5" y="89.4049">coverData</text></g><!--link GMN23 to GMN33--><g id="link_GMN23_GMN33"><path d="M2973.37,172.9179 C2988.45,172.9179 3003.53,172.9179 3018.61,172.9179 " fill="none" id="GMN23-GMN33" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--link UploadService to Cache--><g id="link_UploadService_Cache"><path codeLine="60" d="M987.7,163.6479 C1066.7,154.0479 1196.29,139.5079 1308.5,132.5079 C2167.27,78.9779 2383.62,98.9279 3244,89.3279 C3287.78,88.8379 3400.77,72.0679 3441,89.3279 C3471,102.1979 3491.7154,127.5666 3505.2154,147.9366 " fill="none" id="UploadService-to-Cache" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="3508.53,152.9379,3506.8923,143.2262,3505.7678,148.7701,3500.2239,147.6456,3508.53,152.9379" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="3245" y="89.4049">1.1.9:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="3281" y="89.4049">del("book:" + bookId + ":*")</text></g><!--link Cache to UploadService--><g id="link_Cache_UploadService"><path codeLine="61" d="M3508.53,152.9379 C3495.03,132.5679 3471,102.1979 3441,89.3279 C3400.77,72.0679 3287.78,88.8379 3244,89.3279 C2383.62,98.9279 2167.27,78.9779 1308.5,132.5079 C1196.29,139.5079 1072.6562,153.3241 993.6562,162.9241 " fill="none" id="Cache-to-UploadService" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="987.7,163.6479,997.1168,166.533,992.6635,163.0448,996.1517,158.5914,987.7,163.6479" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="40" x="3312" y="89.4049">1.1.10:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="3355" y="89.4049">OK</text></g><!--SRC=[dLRRRkCs47tNLmmC59LTNtBFLa1suJXEcZPUkxQpVGaGC1PZCokHNf9oSq4-Pj67FlMnNv0Vwv3KpR4T10q2MDAScJbpqQ4qqn654qQcaiG4GWeT4IUSJSZBtoz_2MZ0PQUnjnt0vJmI9BG0CYUUzoFqR-we5ieJ-3lHK0dQOSpu5Uz4Z79T0QB0NRv270lnLNK4rr944PKEcDyMO8DpMKTKBjY4MkJIam9yoYAgohZoW-MOGpeNYcaX7ommUrI0Ec91vIjK_go03Md8L8TCPYwXlLecD49tCYtufFS5w8HeSaCKlUAzXz7l5z0ZIgSTEJbsDwRJHqT7-HW65_ts2PnqeTCUj8t5yroNeV6nr4O8e5RR3cer6FH7OsWHq_dMZMbzAp0_vs5hOcfIE33qmW2DySES1X0daMPp8dNhLiYu4IB5AtwBx0DWCR9ltStfz8gt4pqJaZqIpGGFu9WIYLbjch7uIZdIAiWWjQMvENPDoo-n1jjVtn6hWqbNzRnb7moIpIhpTn5k6G_xdFfFB0p0XNYkUZaM_R9c5dxESzIzw7R6K8FJORzdNHNyyKjts0KM7dtoShV6sjpD7HF3U9avbX9kAhTmM5DRUM5pXrtZi20Hmp7GSzD-t_M62qr1ikbCUu1_Nom4Nzb_gGhiamRqpdjTq3XJy8l1rTCXplcqckB6-EBpcO3uvVizYmNu-xtZp7R2OigLYOhcVpZwAl3tjhRk3xQsgXxb8HWYtXBtpUNlbQi9tzk3VUCrbs92bNgZ1GE784XOYwm7PrGI2NgMn3USi0Zy7UI-QxWxUr-p67TOmhV4qa9vyp_i_v2PHoHQe17tVCeuYU2d8bHH_AlgFvPVzQ88jt1_IgQfdxvvhQTqMLjPWkkd967XS_DkZjCfXsbiR8xRgIp0WEZPUmdjla78blb_sDWHM-zrL3Pkne5nUofNKI-Yr46nHrg7q2uZoerwNhCxkKBdGGzDK4KMg0oPiDZbNmdFr42YHJwWR1HXrkd6eHlZ-UTHTpZ6dt4VNEl0QjSrot9SpuiawJLJrtENfdh5lxGlBhiZy3_L8VrVMUYS5Ho1bWa5HG4b6KmGoYI1YJc8NoDlIOIu2L42cQ40ltoNJ1JBkYHfQrhcridMP4Mjr8wDm_kGkwmRYpaMS-ZF1XhIoA-OTWKLVAFSQF2Y4jGgs7-BtvniUyk4wF-sachDyLSgPkaqCb1tPXgO1UriRKD7KgDBy6GzSCViG6w4rY86SPjzpPYErsgdKN8lrdySrMeMizq4-xs38tbCJpc3iEiHWv-ViqviTfgfYACKKOZOGWgWzmndPSsxkTdvEu6p8dMAnpJHgDk_3hfdhS7disfXoxJTZyazvBg-ITgjSQ-PI-bgBYk8kTeKputEbcHME5aDXKNiDs58frXAkhEuYN13-4IK0W_AIurhdAzqO7U_H9l6XAbbXDrv2pbemZbt9mn6CfiK2jTCQpuqJ534E7xf8Zi5OVeMfKFj8iT49z9-2BVbjuGjX0hIURRCfz2AKdePiJKQdjjUoscMxt9ueMplGfAdQK3Bd6_gFOV4smuhMNCL-0y0]--></g></svg>